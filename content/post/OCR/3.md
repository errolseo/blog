---
title: "[OCR] Synthetic text image (2)"
date: 2022-03-22T00:00:00+09:00
categories:
- OCR
tags:
- synthtiger
thumbnailImage: /images/OCR/3-fig2.png
thumbnailImagePosition: right
summary: synthtiger
katex: true
---
{{< alert warning >}}
본문의 내용은 개인적인 정리를 위해 작성되었기에 학술적이지 않습니다.  
또한 증명되지 않은 내용이 포함되어 있을 가능성이 존재합니다.
{{< /alert >}}

### 1.
작성일 기준, 상위 5개의 [scene text recognition(STR) State-of-the-Art(SOTA) 논문](https://paperswithcode.com/task/scene-text-recognition) 모두 이전 장에서 다룬 MJ+ST를 학습 데이터로 사용해 작성되었다. 기존 모델과의 비교를 위해 같은 데이터를 사용하는 부분도 있으며, 새로운 데이터들의 공신력이 크지 않은 점도 있다. 하지만 MJ, ST보다 더 나은 데이터가 존재하지 않는 것은 아니다.

### 2.
2021년 7월에 공개된 [SynthTIGER](https://arxiv.org/abs/2107.09313)에서는 기존 MJ, ST에 비해 개선된 데이터를 생성해 STR 모델의 성능에 기여하려는 노력을 찾을 수 있었다.

{{< image classes="center" src="/images/OCR/3-fig1.png" title="Fig. 1: Samples of synthetic dataset (Ours = SynthTIGER)" >}}

논문의 저자들은 SynthTIGER가 MJ와 같은 word box image를 생성하지만 ST 수준의 노이즈를 포함한 데이터라고 소개한다. word box image는 scene text image에 비해 이미지 한 장이 가지는 정보량이 적어 단순하게 비교하면 word box image의 필요성을 못 느낄 수 있다. 하지만 {{< hl-text primary >}}scene text image도 STR 모델의 입력 형태인 word box image로 crop되는 과정에서 결국은 <b>모든 배경 정보를 소실</b>한다.{{< /hl-text >}} STR 모델의 입장에서는 굳이 소실될 정보 때문에 자신이 입력으로 받을 데이터의 품질이 손해보는 일은 없는 편이 좋다.

{{< image classes="center" src="/images/OCR/3-fig2.png" title="Fig. 2: The performance of rendering functions" >}}
{{< image classes="center" src="/images/OCR/3-fig3.png" title="Fig. 3: Rendering effect visualization of SynthTIGER modules" >}}

논문에서는 rendering function들이 STR 모델의 정확도에 얼마나 영향을 주는지에 대한 수치를 제공한다. Regular(IIIT5k, SVT, IC03, IC13), Irregular(IC15, SVTP, CUTE80)의 차이는 dataset 속 텍스트의 형태가 단순한가 복잡한가의 차이로 볼 수 있다. 결과에서 흥미로운 부분을 많이 찾을 수 있었기에 정리해 보았다.
1. Post-processing
    - Irregular 데이터에는 흐릿한 사진 등의 노이즈가 많이 포함되어 있기 때문에 post-processing의 영향이 큰 것이 실제 실험을 통해 확인됨
2. Texture blending
    - Scene text image 내의 텍스트는 자연 현상에 의해 훼손(기스, 발색 등)이 필연적으로 존재함
    - 하지만 SynthTIGER에서 사용한 texture image는 우리가 흔히 아는 질감을 표현한 것이 아닌, background image를 재활용했을 뿐이기에 현실의 질감을 재현한 것보다는 노이즈에 가까움
    - 그럼에도 불구하고 텍스트 내부 노이즈의 유무는 STR 모델 성능에 큰 영향을 줌
3. Blending modes
    - Background image의 합성 여부를 나타낸 이 지표가 생각보다 STR 모델 성능에 영향을 주지 않음
    - 생각해보면 대부분의 Scene text image 내의 텍스트는 흔들림, 훼손됨 등의 노이즈를 제외하면 가독성을 위해 단색의 배경 위에 구분이 쉬운 색상을 이용해 작성되어 있는 것을 확인할 수 있음

실험의 흥미로운 결과에 대해 필자가 나름대로 이유를 분석해 보았다. 추후 필자가 만약 word box image를 만든다면 background image 보다는 texture image를 background와 foreground에 각각 blending할 것 같다. 또한 post-processing에서 이미지 전체에 작은 노이즈를 추가하는 것뿐만 아니라 이미지 일부에 강한 노이즈를 추가할 것 같다.

### 3.
OCR 인조 데이터를 생성하는 과정에서 렌더링할 텍스트의 내용은 무작위로 정해지지 않는다. [SynthTIGER의 경우](https://github.com/clovaai/synthtiger/tree/master/resources/corpus) MJ와 ST에서 사용한 말뭉치(corpus)를 섞어 사용하였고, ST의 경우 [Newsgroup 20 dataset](https://archive.ics.uci.edu/ml/datasets/Twenty+Newsgroups)의 corpus를 사용했다. 이런 과정이 필요한 이유에 대해 설명하기 위해서는 언어라는 데이터의 특성을 알아야 한다.

{{< image classes="center" src="/images/OCR/3-fig4.png" title="Fig. 4: Likelihood에 따른 예측 확률 (티, 터, 타)" >}}

Fig.4의 가려진 부분에 대해 '티, 터, 타'가 모두 가능하지만 '컴퓨터'일 확률이 높다고 우리는 예측할 수 있다. 이처럼 우리는 텍스트에 심각한 노이즈가 포함되어 있어도 경험에 의해 확률이 높은 선택지를 추려낼 수 있다. STR 모델에게도 이러한 경험적인 지식을 학습시킨다면 노이즈가 심한 이미지에서도 더 나은 확률로 정답을 유추해낼 수 있을 것이다. 이러한 경험적인 지식을 학습시키기 위해 무작위 알파벳의 조합보다는 실제로 사용하는 단어들을 사용하는 것이 좋다.  
SynthTIGER는 
{{< image classes="center" src="/images/OCR/3-fig5.png" title="Fig. 5: STR accuracy by length distributions" >}}
{{< image classes="center" src="/images/OCR/3-fig6.png" title="Fig. 6: STR accuracy by character distributions" >}}



#### Reference
[1] M. Yim et al. [SynthTIGER: Synthetic Text Image GEneratoR Towards Better Text Recognition Models](https://arxiv.org/abs/2107.09313)